schemaVersion: 2.2.2
metadata:
  name: python-debug-stable
  displayName: Python (Debug Mode)
  attributes:
    # Disable the auto-editor injection so we have full control
    controller.devfile.io/devworkspace-config:
      workspace:
        progressTimeout: "15m"
components:
  - name: tools
    container:
      image: quay.io/devfile/universal-developer-image:ubi8-latest
      memoryLimit: 2Gi
      mountSources: true
      # 1. Start a simple Python server to trick the Health Check
      command: ["/bin/sh", "-c"]
      args: ["echo 'Starting Fake Editor...'; python3 -m http.server 3100 & tail -f /dev/null"]
      endpoints:
        - name: fake-editor
          targetPort: 3100
          attributes:
            type: main
            path: /
            discoverable: true
            public: true
      env:
        - name: HOME
          value: /projects
commands:
  - id: run-app
    exec:
      commandLine: python app.py
      workingDir: ${PROJECT_SOURCE}
      component: tools
      group:
        kind: run
        isDefault: true
